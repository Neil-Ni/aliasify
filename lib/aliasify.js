// Generated by CoffeeScript 1.6.3
(function() {
  var path, transformTools;

  path = require('path');

  transformTools = require('browserify-transform-tools');

  module.exports = transformTools.makeRequireTransform("aliasify", function(args, opts, done) {
    var aliases, configDir, fileDir, replacement, verbose, _ref, _ref1;
    if (!opts.config) {
      return done(new Error("Could not find configuration for aliasify"));
    }
    aliases = opts.config.aliases;
    verbose = opts.config.verbose;
    configDir = ((_ref = opts.configData) != null ? _ref.configDir : void 0) || ((_ref1 = opts.config) != null ? _ref1.configDir : void 0) || process.cwd;
    if ((args.length > 0) && (aliases != null) && (aliases[args[0]] != null)) {
      replacement = aliases[args[0]];
      if (replacement.length > 0 && replacement[0] === '.') {
        replacement = path.resolve(configDir, replacement);
        fileDir = path.dirname(opts.file);
        replacement = "./" + (path.relative(fileDir, replacement));
      }
      if (verbose) {
        console.log("aliasify - " + opts.file + ": replacing " + args[0] + " with " + replacement);
      }
      return done(null, "require('" + replacement + "')");
    } else {
      return done();
    }
  });

}).call(this);
